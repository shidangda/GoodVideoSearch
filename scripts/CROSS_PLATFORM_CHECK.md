# è·¨å¹³å°å…¼å®¹æ€§æ£€æŸ¥æ¸…å•

## âœ… å·²ä¿®å¤çš„å…¼å®¹æ€§é—®é¢˜

### 1. è·¯å¾„åˆ†éš”ç¬¦
- âœ… **PowerShell è„šæœ¬**ï¼šä½¿ç”¨ `Join-Path` æ›¿ä»£ç¡¬ç¼–ç çš„åæ–œæ 
- âœ… **ZIP æ–‡ä»¶**ï¼šä½¿ç”¨ .NET ZipFile ç±»ç¡®ä¿æ‰€æœ‰è·¯å¾„ä½¿ç”¨æ­£æ–œæ ï¼ˆ`/`ï¼‰
- âœ… **è§£å‹è„šæœ¬**ï¼šè‡ªåŠ¨å¤„ç†è·¯å¾„åˆ†éš”ç¬¦è­¦å‘Š

### 2. æ–‡ä»¶ç¼–ç 
- âœ… **MySQL é…ç½®æ–‡ä»¶**ï¼šä½¿ç”¨ ASCII ç¼–ç  + Unix æ¢è¡Œç¬¦ï¼ˆLFï¼‰
- âœ… **SQL æ–‡ä»¶**ï¼šä½¿ç”¨ UTF-8 æ—  BOM ç¼–ç ï¼ˆè·¨å¹³å°å…¼å®¹ï¼‰
- âœ… **æ¸…å•æ–‡ä»¶**ï¼šä½¿ç”¨ UTF-8 ç¼–ç 

### 3. å‹ç¼©æ ¼å¼
- âœ… **Windows â†’ Linux**ï¼šZIP æ–‡ä»¶ä½¿ç”¨æ­£æ–œæ è·¯å¾„åˆ†éš”ç¬¦
- âœ… **Linux â†’ Windows**ï¼štar.gz æ–‡ä»¶ï¼ˆPowerShell è„šæœ¬æç¤ºä½¿ç”¨ WSL/Git Bashï¼‰

### 4. é”™è¯¯å¤„ç†
- âœ… **é€€å‡ºç **ï¼šæ‰€æœ‰è„šæœ¬ä½¿ç”¨æ ‡å‡†é€€å‡ºç ï¼ˆ0=æˆåŠŸï¼Œé0=å¤±è´¥ï¼‰
- âœ… **é”™è¯¯è¾“å‡º**ï¼šä½¿ç”¨ `>&2` é‡å®šå‘åˆ°æ ‡å‡†é”™è¯¯
- âœ… **æ¸…ç†é€»è¾‘**ï¼šä½¿ç”¨ `trap` å’Œ `try-finally` ç¡®ä¿èµ„æºæ¸…ç†

## ğŸ“‹ å…¼å®¹æ€§æµ‹è¯•çŸ©é˜µ

### Windows PowerShell â†’ Ubuntu Linux

| æ“ä½œ | Windows è„šæœ¬ | Linux è„šæœ¬ | çŠ¶æ€ |
|------|-------------|-----------|------|
| å¤‡ä»½ | `export-data.ps1` | - | âœ… ç”Ÿæˆ ZIP |
| æ¢å¤ | - | `import_data.sh` | âœ… æ”¯æŒ ZIP |
| è·¯å¾„åˆ†éš”ç¬¦ | æ­£æ–œæ  | æ­£æ–œæ  | âœ… å…¼å®¹ |
| æ–‡ä»¶ç¼–ç  | UTF-8 æ—  BOM | UTF-8 | âœ… å…¼å®¹ |

### Ubuntu Linux â†’ Windows PowerShell

| æ“ä½œ | Linux è„šæœ¬ | Windows è„šæœ¬ | çŠ¶æ€ |
|------|-----------|-------------|------|
| å¤‡ä»½ | `export_data.sh` | - | âœ… ç”Ÿæˆ tar.gz |
| æ¢å¤ | - | `import-data.ps1` | âš ï¸ éœ€ WSL/Git Bash |
| è·¯å¾„åˆ†éš”ç¬¦ | æ­£æ–œæ  | æ­£æ–œæ  | âœ… å…¼å®¹ |
| æ–‡ä»¶ç¼–ç  | UTF-8 | UTF-8 | âœ… å…¼å®¹ |

## ğŸ” è¯¦ç»†æ£€æŸ¥é¡¹

### è·¯å¾„å¤„ç†

#### âœ… PowerShell è„šæœ¬
```powershell
# æ­£ç¡®ï¼šä½¿ç”¨ Join-Pathï¼ˆè·¨å¹³å°ï¼‰
$path = Join-Path $dir (Join-Path "data" "covers")

# é”™è¯¯ï¼šç¡¬ç¼–ç åæ–œæ ï¼ˆå·²ä¿®å¤ï¼‰
# $path = "$dir\data\covers"
```

#### âœ… Bash è„šæœ¬
```bash
# æ­£ç¡®ï¼šä½¿ç”¨æ­£æ–œæ ï¼ˆè·¨å¹³å°ï¼‰
COVERS_SRC="$PROJECT_DIR/data/covers"
```

### æ–‡ä»¶ç¼–ç 

#### âœ… MySQL é…ç½®æ–‡ä»¶
- **æ ¼å¼**ï¼šASCII ç¼–ç 
- **æ¢è¡Œç¬¦**ï¼šUnix LF (`\n`)
- **åŸå› **ï¼šMySQL å®¢æˆ·ç«¯åœ¨æ‰€æœ‰å¹³å°éƒ½æ”¯æŒ

#### âœ… SQL æ–‡ä»¶
- **æ ¼å¼**ï¼šUTF-8 æ—  BOM
- **åŸå› **ï¼šè·¨å¹³å°å…¼å®¹ï¼Œé¿å… BOM å¯¼è‡´çš„è§£æé—®é¢˜

### å‹ç¼©æ ¼å¼

#### âœ… ZIP æ–‡ä»¶ï¼ˆWindows â†’ Linuxï¼‰
- **è·¯å¾„åˆ†éš”ç¬¦**ï¼šæ­£æ–œæ ï¼ˆ`/`ï¼‰
- **å·¥å…·**ï¼š.NET ZipFile ç±»
- **å…¼å®¹æ€§**ï¼šLinux `unzip` å®Œå…¨æ”¯æŒ

#### âœ… tar.gz æ–‡ä»¶ï¼ˆLinux â†’ Windowsï¼‰
- **å·¥å…·**ï¼š`tar` å‘½ä»¤
- **Windows æ”¯æŒ**ï¼šéœ€è¦ WSL æˆ– Git Bash
- **å»ºè®®**ï¼šåœ¨ Windows ä¸Šä½¿ç”¨ WSL è¿è¡Œ Bash è„šæœ¬

### é”™è¯¯å¤„ç†

#### âœ… é€€å‡ºç 
```bash
# Bash
exit 0  # æˆåŠŸ
exit 1  # å¤±è´¥
```

```powershell
# PowerShell
exit 0  # æˆåŠŸ
exit 1  # å¤±è´¥
```

#### âœ… é”™è¯¯è¾“å‡º
```bash
# Bash
echo "Error" >&2
```

```powershell
# PowerShell
Write-Host "Error" -ForegroundColor Red
```

## ğŸ§ª æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šWindows å¤‡ä»½ â†’ Linux æ¢å¤

```powershell
# Windows
.\scripts\export-data.ps1
# ç”Ÿæˆ: backups/gvs-backup-YYYYMMDD-HHMMSS.zip
```

```bash
# Linux
bash scripts/import_data.sh backups/gvs-backup-*.zip
# âœ… åº”è¯¥æˆåŠŸæ¢å¤
```

### åœºæ™¯ 2ï¼šLinux å¤‡ä»½ â†’ Windows æ¢å¤

```bash
# Linux
bash scripts/export_data.sh
# ç”Ÿæˆ: backups/gvs-backup-YYYYMMDD-HHMMSS.tar.gz
```

```powershell
# Windows (éœ€è¦ WSL æˆ– Git Bash)
wsl bash scripts/import_data.sh backups/gvs-backup-*.tar.gz
# æˆ–
bash scripts/import_data.sh backups/gvs-backup-*.tar.gz
```

### åœºæ™¯ 3ï¼šLinux å¤‡ä»½ â†’ Linux æ¢å¤

```bash
# å¤‡ä»½
bash scripts/export_data.sh

# æ¢å¤
bash scripts/import_data.sh backups/gvs-backup-*.tar.gz
# âœ… å®Œå…¨å…¼å®¹
```

### åœºæ™¯ 4ï¼šWindows å¤‡ä»½ â†’ Windows æ¢å¤

```powershell
# å¤‡ä»½
.\scripts\export-data.ps1

# æ¢å¤
.\scripts\import-data.ps1 backups\gvs-backup-*.zip
# âœ… å®Œå…¨å…¼å®¹
```

## âš ï¸ å·²çŸ¥é™åˆ¶

1. **tar.gz åœ¨ Windows PowerShell**
   - PowerShell çš„ `Expand-Archive` ä¸æ”¯æŒ tar.gz
   - **è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨ WSL æˆ– Git Bash

2. **è·¯å¾„å¤§å°å†™**
   - Windows æ–‡ä»¶ç³»ç»Ÿä¸åŒºåˆ†å¤§å°å†™
   - Linux æ–‡ä»¶ç³»ç»ŸåŒºåˆ†å¤§å°å†™
   - **å½±å“**ï¼šæ–‡ä»¶åéœ€è¦ä¿æŒä¸€è‡´çš„å¤§å°å†™

3. **æ–‡ä»¶æƒé™**
   - Windows å’Œ Linux çš„æ–‡ä»¶æƒé™ç³»ç»Ÿä¸åŒ
   - **å¤„ç†**ï¼šè„šæœ¬ä¸­å·²è®¾ç½®å¿…è¦çš„æƒé™ï¼ˆå¦‚ MySQL é…ç½®æ–‡ä»¶ 600ï¼‰

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šZIP æ–‡ä»¶è·¯å¾„åˆ†éš”ç¬¦è­¦å‘Š

**ç—‡çŠ¶**ï¼š`backslashes as path separators` è­¦å‘Š

**åŸå› **ï¼šæ—§ç‰ˆæœ¬è„šæœ¬åˆ›å»ºçš„ ZIP æ–‡ä»¶ä½¿ç”¨äº†åæ–œæ 

**è§£å†³**ï¼š
1. ä½¿ç”¨ä¿®å¤åçš„è„šæœ¬é‡æ–°å¤‡ä»½
2. æˆ–å¿½ç•¥è­¦å‘Šï¼ˆä¸å½±å“è§£å‹ï¼‰

### é—®é¢˜ 2ï¼šæ–‡ä»¶ç¼–ç é—®é¢˜

**ç—‡çŠ¶**ï¼šSQL æ–‡ä»¶å¯¼å…¥å¤±è´¥æˆ–ä¹±ç 

**è§£å†³**ï¼š
- ç¡®ä¿ä½¿ç”¨ UTF-8 æ—  BOM ç¼–ç 
- æ£€æŸ¥æ•°æ®åº“å­—ç¬¦é›†è®¾ç½®

### é—®é¢˜ 3ï¼šè·¯å¾„æ‰¾ä¸åˆ°

**ç—‡çŠ¶**ï¼š`Cover directory not found`

**è§£å†³**ï¼š
- æ£€æŸ¥ ZIP æ–‡ä»¶å†…å®¹ï¼š`unzip -l archive.zip`
- ç¡®ä¿è·¯å¾„ä½¿ç”¨æ­£æ–œæ 
- ä½¿ç”¨ä¿®å¤åçš„å¤‡ä»½è„šæœ¬é‡æ–°å¤‡ä»½

## ğŸ“ æœ€ä½³å®è·µ

1. **æ€»æ˜¯ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„è„šæœ¬**
2. **åœ¨è¿ç§»å‰éªŒè¯ ZIP/tar.gz æ–‡ä»¶å†…å®¹**
3. **ä½¿ç”¨ UTF-8 ç¼–ç ä¿å­˜æ‰€æœ‰æ–‡æœ¬æ–‡ä»¶**
4. **åœ¨ Linux ä¸Šæµ‹è¯• Windows åˆ›å»ºçš„å¤‡ä»½**
5. **åœ¨ Windows ä¸Šä½¿ç”¨ WSL å¤„ç† tar.gz æ–‡ä»¶**

## âœ… éªŒè¯æ¸…å•

åœ¨æ¯æ¬¡è·¨å¹³å°è¿ç§»å‰ï¼Œæ£€æŸ¥ï¼š

- [ ] ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„è„šæœ¬
- [ ] ZIP æ–‡ä»¶è·¯å¾„ä½¿ç”¨æ­£æ–œæ 
- [ ] SQL æ–‡ä»¶ä½¿ç”¨ UTF-8 æ—  BOM
- [ ] MySQL é…ç½®æ–‡ä»¶ä½¿ç”¨ ASCII + LF
- [ ] æ‰€æœ‰è·¯å¾„ä½¿ç”¨ `Join-Path` æˆ–æ­£æ–œæ 
- [ ] é”™è¯¯å¤„ç†æ­£ç¡®ï¼ˆé€€å‡ºç ã€é”™è¯¯è¾“å‡ºï¼‰
- [ ] ä¸´æ—¶æ–‡ä»¶æ¸…ç†é€»è¾‘å®Œæ•´

